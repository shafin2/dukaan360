<% content_for :page_title, t('products.title') %>

<div class="p-6 max-w-7xl mx-auto space-y-8">
  <!-- Header Section -->
  <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 overflow-hidden">
    <div class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 px-8 py-6">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
        <div>
          <h1 class="text-3xl font-bold text-white mb-2">
            <%= t('products.title') %>
          </h1>
          <p class="text-indigo-100">
            <%= current_user.business_owner? ? "Manage all products in your business" : "View products available in #{current_user.shop.name}" %>
          </p>
        </div>
        <% if current_user.business_owner? %>
          <div class="mt-4 sm:mt-0">
            <%= link_to new_product_path,
                class: "inline-flex items-center px-6 py-3 bg-white text-indigo-600 text-sm font-semibold rounded-xl hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-indigo-600 transition-all duration-200 transform hover:scale-105 shadow-lg no-underline" do %>
              <i data-feather="plus" class="w-4 h-4 mr-2"></i>
              <%= t('products.actions.add_product') %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Search and Filters -->
  <%= render 'shared/products/search_filters' %>

  <!-- Stats Cards -->
  <%= render 'shared/products/stats_cards' %>

  <!-- Products Table -->
  <% if @products.any? %>
    <div class="bg-white rounded-xl shadow border border-gray-200 overflow-hidden">
      <table class="min-w-full divide-y divide-gray-200">
        <%= render 'shared/products/table_header' %>
        <tbody class="divide-y divide-gray-100">
          <% @products.each do |product| %>
            <%= render 'shared/products/product_row', product: product %>
          <% end %>
        </tbody>
      </table>
    </div>
    
    <!-- Pagination -->
    <% if @products.respond_to?(:total_pages) && @products.total_pages > 1 %>
      <div class="mt-6 bg-white rounded-xl shadow border border-gray-200 px-6 py-4">
        <%= render 'shared/products/pagination', products: @products %>
      </div>
    <% end %>
  <% else %>
    <div class="bg-white rounded-xl shadow border border-gray-200 overflow-hidden">
      <%= render 'shared/products/empty_state' %>
    </div>
  <% end %>
</div>

<script>
  // Re-initialize feather icons after content loads
  feather.replace();
</script>

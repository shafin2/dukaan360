<!-- Payment Modal -->
<div id="paymentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto">
    <div class="px-6 py-4 border-b border-gray-200 sticky top-0 bg-white rounded-t-2xl">
      <h3 class="text-xl font-semibold text-gray-900">Record Payment</h3>
      <p class="text-gray-600 mt-1">Bill: <span id="modalBillNumber"></span></p>
      <p class="text-gray-600">Outstanding: <span id="modalOutstanding"></span></p>
    </div>
    
    <form id="paymentForm" method="POST" class="p-6 space-y-4">
      <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
      
      <div>
        <label for="paymentAmount" class="block text-sm font-medium text-gray-700 mb-2">Payment Amount (PKR)</label>
        <input type="number" 
               id="paymentAmount"
               name="payment[amount]" 
               step="0.01" 
               required
               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500"
               placeholder="Enter amount...">
      </div>
      
      <div>
        <label for="paymentMethod" class="block text-sm font-medium text-gray-700 mb-2">Payment Method</label>
        <select id="paymentMethod" 
                name="payment[payment_method]" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500">
          <option value="">Select method...</option>
          <option value="cash">Cash</option>
          <option value="bank_transfer">Bank Transfer</option>
          <option value="card">Card</option>
          <option value="mobile">Mobile Payment</option>
        </select>
      </div>
      
      <div>
        <label for="paymentDate" class="block text-sm font-medium text-gray-700 mb-2">Payment Date</label>
        <input type="date" 
               id="paymentDate"
               name="payment[payment_date]" 
               value="<%= Date.current.strftime('%Y-%m-%d') %>"
               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500">
      </div>
      
      <div>
        <label for="paymentNotes" class="block text-sm font-medium text-gray-700 mb-2">Notes (Optional)</label>
        <textarea id="paymentNotes"
                  name="payment[notes]" 
                  rows="3"
                  class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500"
                  placeholder="Payment notes..."></textarea>
      </div>
      
      <div class="flex space-x-3 pt-4 sticky bottom-0 bg-white pb-2">
        <button type="button" 
                onclick="closePaymentModal()" 
                class="flex-1 px-4 py-3 bg-gray-500 text-white font-medium rounded-xl hover:bg-gray-600 transition-colors">
          Cancel
        </button>
        <button type="submit" 
                class="flex-1 px-4 py-3 bg-green-600 text-white font-medium rounded-xl hover:bg-green-700 transition-colors">
          Record Payment
        </button>
      </div>
    </form>
  </div>
</div> 